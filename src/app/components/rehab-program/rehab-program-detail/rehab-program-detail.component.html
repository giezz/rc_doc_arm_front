<ng-container *ngIf="isLoaded; else loading">
  <div class="rehab-program-info tui-space_bottom-3">
    <label
      [tuiLabel]="'Врач'">{{rehabProgram.doctor.lastName}} {{rehabProgram.doctor.firstName}} {{rehabProgram.doctor.middleName}}</label>
    <label [tuiLabel]="'Статус'">
      <tui-badge
        [status]="status"
        size="l"
        class="tui-space_right-2 tui-space_bottom-2"
        [value]="value"
      ></tui-badge>
    </label>
  </div>
  <div class="rehab-program-info tui-space_bottom-3">
    <label [tuiLabel]="'Дата начала'">{{rehabProgram.startDate | date}}</label>
    <label *ngIf="!rehabProgram.isCurrent" [tuiLabel]="'Дата окончания'">{{rehabProgram.endDate | date}}</label>
  </div>
  <tui-accordion [closeOthers]="false">
    <tui-accordion-item [open]="true">
      Входные анкеты
      <ng-template tuiAccordionItemContent>
        <div class="forms-block-container">
        <ng-container *ngFor="let startForm of rehabProgram.forms" style="display:flex;">
            <app-form-card *ngIf="startForm.typeId === 1" [form]="startForm.form" class="border-shadow"></app-form-card>
        </ng-container>
        </div>
        <button
          *ngIf="rehabProgram.isCurrent"
          class="tui-space_top-3"
          tuiButton
          appearance="secondary"
          size="m"
          (click)="showAddFormDialog('START')"
        >
          Добавить анкету
        </button>
      </ng-template>
    </tui-accordion-item>
    <tui-accordion-item [open]="true">
      Модули
      <ng-template tuiAccordionItemContent>
        <app-module-block
          *ngFor="let module of rehabProgram.modules; let i = index"
          [module]="module"
          [editable]="rehabProgram.isCurrent"
          [index]="i"
          class="module-island border-shadow"
        ></app-module-block>
        <button
          *ngIf="rehabProgram.isCurrent"
          class="tui-space_top-3"
          tuiButton
          appearance="secondary"
          size="m"
          (click)="showAddModuleDialog()"
        >
          Добавить модуль
        </button>
      </ng-template>
    </tui-accordion-item>
    <tui-accordion-item [open]="true">
      Выходные анкеты
      <ng-template tuiAccordionItemContent>
        <ng-container *ngFor="let endForm of rehabProgram.forms">
          <app-form-card *ngIf="endForm.typeId === 2" [form]="endForm.form" class="border-shadow"></app-form-card>
        </ng-container>
        <button
          *ngIf="rehabProgram.isCurrent"
          class="tui-space_top-3"
          tuiButton
          appearance="secondary"
          size="m"
          (click)="showAddFormDialog('END')"
        >
          Добавить анкету
        </button>
      </ng-template>
    </tui-accordion-item>
  </tui-accordion>
  <!--  <app-detail-card-->
  <!--    heading="Входные анкеты"-->
  <!--    [padding]="false"-->
  <!--    [border]="false"-->
  <!--    [boxShadow]="false"-->
  <!--  >-->
  <!--    <div class="forms-block-container">-->
  <!--      <ng-container *ngFor="let startForm of rehabProgram.forms">-->
  <!--        <app-form-card *ngIf="startForm.typeId === 1" [form]="startForm.form" class="border-shadow"></app-form-card>-->
  <!--      </ng-container>-->
  <!--    </div>-->
  <!--    <button-->
  <!--      *ngIf="rehabProgram.isCurrent"-->
  <!--      class="tui-space_top-3"-->
  <!--      tuiButton-->
  <!--      appearance="primary"-->
  <!--      size="s"-->
  <!--      (click)="showAddFormDialog('START')"-->
  <!--    >-->
  <!--      Добавить анкету-->
  <!--    </button>-->
  <!--  </app-detail-card>-->
  <!--  <app-detail-card-->
  <!--    heading="Модули"-->
  <!--    [padding]="false"-->
  <!--    [border]="false"-->
  <!--    [boxShadow]="false"-->
  <!--  >-->
  <!--    <div class="modules-wrapper">-->
  <!--      <app-module-block-->
  <!--        *ngFor="let module of rehabProgram.modules; let i = index"-->
  <!--        [module]="module"-->
  <!--        [editable]="rehabProgram.isCurrent"-->
  <!--        [index]="i"-->
  <!--        class="module-island border-shadow"-->
  <!--      ></app-module-block>-->
  <!--    </div>-->
  <!--    <button-->
  <!--      *ngIf="rehabProgram.isCurrent"-->
  <!--      tuiButton-->
  <!--      appearance="primary"-->
  <!--      size="s"-->
  <!--      (click)="showAddModuleDialog()"-->
  <!--    >-->
  <!--      Добавить модуль-->
  <!--    </button>-->
  <!--  </app-detail-card>-->
  <!--  <app-detail-card-->
  <!--    heading="Выходные анкеты"-->
  <!--    [padding]="false"-->
  <!--    [border]="false"-->
  <!--    [boxShadow]="false"-->
  <!--  >-->
  <!--    <div class="forms-block-container">-->
  <!--      <ng-container *ngFor="let endForm of rehabProgram.forms">-->
  <!--        <app-form-card *ngIf="endForm.typeId === 2" [form]="endForm.form" class="border-shadow"></app-form-card>-->
  <!--      </ng-container>-->
  <!--    </div>-->
  <!--    <button-->
  <!--      *ngIf="rehabProgram.isCurrent"-->
  <!--      class="tui-space_top-3"-->
  <!--      tuiButton-->
  <!--      appearance="primary"-->
  <!--      size="s"-->
  <!--      (click)="showAddFormDialog('END')"-->
  <!--    >-->
  <!--      Добавить анкету-->
  <!--    </button>-->
  <!--  </app-detail-card>-->

  <!--    <button-->
  <!--      tuiButton-->
  <!--      appearance="primary"-->
  <!--      size="s"-->
  <!--    >-->
  <!--      Сохранить-->
  <!--    </button>-->
</ng-container>
<ng-template #loading>
  <tui-loader [showLoader]="true" [size]="'xxl'" class="loader"></tui-loader>
</ng-template>
